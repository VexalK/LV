<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>创建新应用 - 轻芒商店</title>
    <link rel="icon" href="favicon.svg" type="image/svg+xml">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#165DFF',
                        secondary: '#36CFC9',
                        dark: '#1D2129',
                        light: '#F2F3F5',
                        gray: {
                            100: '#F7F8FA',
                            200: '#E5E6EB',
                            300: '#C9CDD4',
                            400: '#86909C',
                            500: '#4E5969',
                            600: '#272E3B',
                            700: '#1D2129',
                        },
                    },
                    fontFamily: {
                        inter: ['Inter', 'system-ui', 'sans-serif'],
                    },
                    boxShadow: {
                        'card': '0 4px 20px 0 rgba(0, 0, 0, 0.05)',
                        'hover': '0 10px 30px 0 rgba(22, 93, 255, 0.1)',
                    }
                },
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .form-input-focus {
                @apply focus:ring-2 focus:ring-primary/30 focus:border-primary transition-all duration-200;
            }
            .btn-primary {
                @apply bg-primary text-white font-medium py-3 px-6 rounded-xl hover:bg-primary/90 active:bg-primary/80 transition-all duration-200 shadow-sm hover:shadow focus:outline-none focus:ring-2 focus:ring-primary/50 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed;
            }
            .btn-secondary {
                @apply bg-white border border-gray-200 text-gray-700 font-medium py-3 px-6 rounded-xl hover:bg-gray-50 active:bg-gray-100 transition-all duration-200 shadow-sm focus:outline-none focus:ring-2 focus:ring-gray-300 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed;
            }
            .upload-area {
                @apply border-2 border-dashed border-gray-300 rounded-xl p-6 text-center hover:border-primary hover:bg-primary/5 transition-all duration-300 cursor-pointer;
            }
            .card-hover {
                @apply transition-all duration-300 hover:shadow-hover transform hover:-translate-y-1;
            }
        }
    </style>
</head>
<body class="font-inter bg-gray-100 text-gray-700 min-h-screen flex flex-col">
    <!-- 导航栏 -->
    <header id="app-header" class="bg-white shadow-sm fixed top-0 left-0 right-0 z-50 transition-all duration-300">
        <div class="container mx-auto px-4">
            <div class="flex items-center justify-between h-16 md:h-20">
                <!-- Logo -->
                <div class="flex items-center">
                    <a href="index.html" class="flex items-center space-x-2">
                        <div class="w-10 h-10 rounded-xl bg-primary flex items-center justify-center">
                            <i class="fa fa-rocket text-white text-xl"></i>
                        </div>
                        <span class="text-xl font-bold bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent">轻芒商店</span>
                    </a>
                </div>
                
                <!-- 导航链接 - 桌面版 -->
                <nav class="hidden md:flex space-x-8">
                    <a href="index.html" class="font-medium text-gray-600 hover:text-primary transition-colors px-1 py-5">首页</a>
                    <a href="category.html" class="font-medium text-gray-600 hover:text-primary transition-colors px-1 py-5">分类</a>
                    <a href="ranking.html" class="font-medium text-gray-600 hover:text-primary transition-colors px-1 py-5">排行榜</a>
                    <a href="my-notifications.html" class="text-gray-600 hover:text-primary transition-colors px-1 py-5"><i class="fa fa-bell mr-2"></i>我的通知</a>
                    <a href="create-app.html" class="text-primary font-medium border-b-2 border-primary px-1 py-5">创建应用</a>
                </nav>
                
                <!-- 移动端菜单按钮 -->
                <div class="flex items-center md:hidden">
                    <button id="mobile-menu-button" class="text-gray-600 hover:text-primary transition-colors p-2">
                        <i class="fa fa-bars text-xl"></i>
                    </button>
                </div>
            </div>
            
            <!-- 移动端菜单 -->
            <div id="mobile-menu" class="hidden md:hidden bg-white border-t border-gray-200 py-3 px-4 shadow-lg">
                <nav class="flex flex-col space-y-3">
                    <a href="index.html" class="font-medium text-gray-600 hover:text-primary transition-colors px-3 py-2 rounded-lg hover:bg-gray-50">首页</a>
                    <a href="category.html" class="font-medium text-gray-600 hover:text-primary transition-colors px-3 py-2 rounded-lg hover:bg-gray-50">分类</a>
                    <a href="ranking.html" class="font-medium text-gray-600 hover:text-primary transition-colors px-3 py-2 rounded-lg hover:bg-gray-50">排行榜</a>
                    <a href="my-notifications.html" class="font-medium text-gray-600 hover:text-primary transition-colors px-3 py-2 rounded-lg hover:bg-gray-50"><i class="fa fa-bell mr-2"></i>我的通知</a>
                    <a href="create-app.html" class="font-medium bg-primary/10 text-primary px-3 py-2 rounded-lg">创建应用</a>
                </nav>
            </div>
        </div>
    </header>

    <!-- 主内容区 -->
    <main class="flex-grow pt-20 md:pt-24 pb-16">
        <div class="container mx-auto px-4">
            <div class="max-w-4xl mx-auto">
                <!-- 页面标题 -->
                <div class="mb-8 text-center">
                    <h1 class="text-[clamp(1.75rem,3vw,2.5rem)] font-bold text-gray-800 mb-2">创建新应用</h1>
                    <p class="text-gray-500 max-w-2xl mx-auto">填写以下信息创建您的应用，创建后将提交审核，审核通过后将在应用商店中显示</p>
                </div>

                <!-- 创建应用卡片 -->
                <div class="bg-white rounded-2xl shadow-card overflow-hidden mb-8 card-hover">
                    <div class="p-6 md:p-8">
                        <form id="create-app-form" class="space-y-8">
                            <!-- 基本信息区域 -->
                            <div class="border-b border-gray-200 pb-6">
                                <h2 class="text-xl font-semibold mb-6 flex items-center text-gray-800">
                                    <i class="fa fa-info-circle text-primary mr-2"></i>基本信息
                                </h2>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div class="space-y-2">
                                        <label for="app-name" class="block text-sm font-medium text-gray-700">应用名称 <span class="text-red-500">*</span></label>
                                        <input type="text" id="app-name" name="name" required
                                            class="w-full px-4 py-3 border border-gray-300 rounded-xl form-input-focus"
                                            placeholder="输入应用名称">
                                    </div>
                                    <div class="space-y-2">
                                        <label for="app-developer" class="block text-sm font-medium text-gray-700">开发商 <span class="text-red-500">*</span></label>
                                        <input type="text" id="app-developer" name="developer" required
                                            class="w-full px-4 py-3 border border-gray-300 rounded-xl form-input-focus"
                                            placeholder="输入开发商名称">
                                    </div>
                                </div>

                                <div class="space-y-2 mt-6">
                                    <label for="app-description" class="block text-sm font-medium text-gray-700">应用描述 <span class="text-red-500">*</span></label>
                                    <textarea id="app-description" name="description" rows="4" required
                                        class="w-full px-4 py-3 border border-gray-300 rounded-xl form-input-focus"
                                        placeholder="详细描述您的应用功能和特点..."></textarea>
                                </div>

                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-6">
                                    <div class="space-y-2">
                                        <label for="app-category" class="block text-sm font-medium text-gray-700">分类 <span class="text-red-500">*</span></label>
                                        <select id="app-category" name="category" required
                                            class="w-full px-4 py-3 border border-gray-300 rounded-xl form-input-focus bg-white appearance-none">
                                            <option value="">选择分类</option>
                                            <option value="生产力">生产力</option>
                                            <option value="娱乐">娱乐</option>
                                            <option value="教育">教育</option>
                                            <option value="社交">社交</option>
                                            <option value="游戏">游戏</option>
                                            <option value="工具">工具</option>
                                            <option value="其他">其他</option>
                                        </select>
                                    </div>
                                    <div class="space-y-2">
                                        <label for="app-language" class="block text-sm font-medium text-gray-700">语言 <span class="text-red-500">*</span></label>
                                        <input type="text" id="app-language" name="language" required
                                            class="w-full px-4 py-3 border border-gray-300 rounded-xl form-input-focus"
                                            placeholder="例如：中文、英文、多语言">
                                    </div>
                                </div>

                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-6">
                                    <div class="space-y-2">
                                        <label for="app-size" class="block text-sm font-medium text-gray-700">应用大小 <span class="text-red-500">*</span></label>
                                        <input type="text" id="app-size" name="size" required
                                            class="w-full px-4 py-3 border border-gray-300 rounded-xl form-input-focus"
                                            placeholder="例如：12.5 MB">
                                    </div>
                                    <div class="space-y-2">
                                        <label for="app-update-date" class="block text-sm font-medium text-gray-700">更新日期 <span class="text-red-500">*</span></label>
                                        <input type="date" id="app-update-date" name="updateDate" required
                                            class="w-full px-4 py-3 border border-gray-300 rounded-xl form-input-focus bg-white">
                                    </div>
                                </div>
                            </div>

                            <!-- 文件上传区域 -->
                            <div class="border-b border-gray-200 pb-6">
                                <h2 class="text-xl font-semibold mb-6 flex items-center text-gray-800">
                                    <i class="fa fa-upload text-primary mr-2"></i>文件上传
                                </h2>
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                                    <!-- 应用图标上传 -->
                                    <div class="space-y-3">
                                        <label class="block text-sm font-medium text-gray-700">应用图标 <span class="text-red-500">*</span></label>
                                        <div id="icon-upload-area" class="upload-area">
                                            <input type="file" id="app-icon" name="icon" accept="image/*" class="hidden"
                                                onchange="handleFileUpload(event, 'icon-preview', 'icon-upload-area')">
                                            <div class="flex flex-col items-center justify-center">
                                                <i class="fa fa-image text-3xl text-gray-400 mb-2"></i>
                                                <p class="text-sm text-gray-500">点击上传图标</p>
                                                <p class="text-xs text-gray-400 mt-1">支持 PNG/JPG/SVG</p>
                                            </div>
                                        </div>
                                        <div id="icon-preview" class="hidden mt-3 rounded-xl overflow-hidden border border-gray-200"></div>
                                    </div>

                                    <!-- 应用程序文件上传 -->
                                    <div class="space-y-3">
                                        <label class="block text-sm font-medium text-gray-700">应用程序文件 <span class="text-red-500">*</span></label>
                                        <div id="exe-upload-area" class="upload-area">
                                            <input type="file" id="app-exe" name="app-exe" accept=".exe,.zip,.rar" class="hidden"
                                                onchange="handleFileUpload(event, 'exe-preview', 'exe-upload-area')">
                                            <div class="flex flex-col items-center justify-center">
                                                <i class="fa fa-file-exe-o text-3xl text-gray-400 mb-2"></i>
                                                <p class="text-sm text-gray-500">点击上传应用文件</p>
                                                <p class="text-xs text-gray-400 mt-1">支持 EXE/ZIP/RAR</p>
                                            </div>
                                        </div>
                                        <div id="exe-preview" class="hidden mt-3"></div>
                                    </div>

                                    <!-- 应用截图上传 -->
                                    <div class="space-y-3">
                                        <label class="block text-sm font-medium text-gray-700">应用截图 <span class="text-red-500">*</span></label>
                                        <div id="screenshot-upload-area" class="upload-area">
                                            <input type="file" id="app-screenshots" name="screenshots" accept="image/*" multiple class="hidden"
                                                onchange="handleScreenshotUpload(event)">
                                            <div class="flex flex-col items-center justify-center">
                                                <i class="fa fa-picture-o text-3xl text-gray-400 mb-2"></i>
                                                <p class="text-sm text-gray-500">点击上传截图</p>
                                                <p class="text-xs text-gray-400 mt-1">最多5张，支持 PNG/JPG</p>
                                            </div>
                                        </div>
                                        <div id="screenshot-preview" class="flex flex-wrap gap-2 mt-3"></div>
                                    </div>
                                </div>
                            </div>

                            <!-- 高级选项 -->
                            <div class="border-b border-gray-200 pb-6">
                                <h2 class="text-xl font-semibold mb-6 flex items-center text-gray-800">
                                    <i class="fa fa-sliders text-primary mr-2"></i>高级选项
                                </h2>
                                <div class="space-y-4">
                                    <div class="flex items-center space-x-4">
                                        <label class="inline-flex items-center">
                                            <input type="radio" name="appType" value="official" class="text-primary focus:ring-primary" checked>
                                            <span class="ml-2">官方作品</span>
                                        </label>
                                        <label class="inline-flex items-center">
                                            <input type="radio" name="appType" value="derivative" class="text-primary focus:ring-primary">
                                            <span class="ml-2">衍生作品</span>
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <!-- 提交按钮 -->
                            <div class="flex justify-end space-x-4 pt-6">
                                <button type="button" id="cancel-btn" class="btn-secondary" onclick="window.location.href='index.html'">
                                    <i class="fa fa-times mr-2"></i>取消
                                </button>
                                <button type="submit" class="btn-primary">
                                    <i class="fa fa-check mr-2"></i>创建应用
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- 页脚 -->
    <footer class="bg-white border-t border-gray-200 py-6">
        <div class="container mx-auto px-4 text-center text-gray-500 text-sm">
            <p>© 2023 轻芒商店 - 安全可靠的应用平台</p>
        </div>
    </footer>

    <!-- 成功提示 -->
    <div id="success-toast" class="fixed bottom-6 right-6 bg-green-500 text-white px-6 py-3 rounded-xl shadow-lg transform translate-y-20 opacity-0 transition-all duration-300 flex items-center z-50">
        <i class="fa fa-check-circle mr-2"></i>
        <span id="toast-message">操作成功！</span>
    </div>

    <script>
        // 日期默认值设置为今天
        document.addEventListener('DOMContentLoaded', function() {
            // 设置默认日期为今天
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('app-update-date').value = today;

            // 移动端菜单切换
            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');

            mobileMenuButton.addEventListener('click', function() {
                mobileMenu.classList.toggle('hidden');
            });

            // 上传区域点击触发文件选择
            document.getElementById('icon-upload-area').addEventListener('click', function() {
                document.getElementById('app-icon').click();
            });

            document.getElementById('exe-upload-area').addEventListener('click', function() {
                document.getElementById('app-exe').click();
            });

            document.getElementById('screenshot-upload-area').addEventListener('click', function() {
                document.getElementById('app-screenshots').click();
            });

            // 表单提交处理
            document.getElementById('create-app-form').addEventListener('submit', function(e) {
                e.preventDefault();
                submitForm();
            });

            // 导航栏滚动效果
            window.addEventListener('scroll', function() {
                const header = document.getElementById('app-header');
                if (window.scrollY > 50) {
                    header.classList.add('shadow-md');
                } else {
                    header.classList.remove('shadow-md');
                }
            });
        });

        // 文件上传处理
        function handleFileUpload(event, previewId, areaId) {
            const file = event.target.files[0];
            if (!file) return;

            const previewContainer = document.getElementById(previewId);
            const uploadArea = document.getElementById(areaId);

            // 清空预览
            previewContainer.innerHTML = '';
            previewContainer.classList.remove('hidden');

            // 显示文件信息
            if (areaId === 'exe-upload-area') {
                // 应用程序文件预览
                const fileInfo = document.createElement('div');
                fileInfo.className = 'bg-gray-50 p-3 rounded-lg flex items-center';
                fileInfo.innerHTML = `
                    <i class="fa fa-file-exe-o text-primary text-xl mr-3"></i>
                    <div class="flex-grow min-w-0">
                        <p class="text-sm font-medium truncate">${file.name}</p>
                        <p class="text-xs text-gray-500">${formatFileSize(file.size)}</p>
                    </div>
                    <button type="button" class="text-gray-400 hover:text-red-500"
                        onclick="removeFile('${event.target.id}', '${previewId}', '${areaId}')">
                        <i class="fa fa-times"></i>
                    </button>
                `;
                previewContainer.appendChild(fileInfo);
            } else {
                // 图片预览
                const reader = new FileReader();
                reader.onload = function(e) {
                    const preview = document.createElement('div');
                    preview.className = 'relative group';
                    preview.innerHTML = `
                        <img src="${e.target.result}" alt="预览图" class="w-full h-auto object-cover rounded-lg">
                        <button type="button" class="absolute top-2 right-2 bg-white bg-opacity-70 rounded-full w-8 h-8 flex items-center justify-center text-red-500 opacity-0 group-hover:opacity-100 transition-opacity"
                            onclick="removeFile('${event.target.id}', '${previewId}', '${areaId}')">
                            <i class="fa fa-times"></i>
                        </button>
                    `;
                    previewContainer.appendChild(preview);
                };
                reader.readAsDataURL(file);
            }

            // 更新上传区域样式
            uploadArea.classList.add('border-primary');
        }

        // 截图上传处理
        function handleScreenshotUpload(event) {
            const files = event.target.files;
            const previewContainer = document.getElementById('screenshot-preview');
            const maxFiles = 5;

            // 检查文件数量
            if (files.length > maxFiles) {
                alert(`最多只能上传${maxFiles}张截图`);
                event.target.value = ''; // 清空选择
                return;
            }

            // 清空现有预览
            previewContainer.innerHTML = '';

            // 显示新预览
            Array.from(files).forEach((file, index) => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const preview = document.createElement('div');
                    preview.className = 'relative group w-24 h-16 rounded-lg overflow-hidden border border-gray-200';
                    preview.innerHTML = `
                        <img src="${e.target.result}" alt="截图预览" class="w-full h-full object-cover">
                        <button type="button" class="absolute top-1 right-1 bg-white bg-opacity-70 rounded-full w-6 h-6 flex items-center justify-center text-red-500 opacity-0 group-hover:opacity-100 transition-opacity"
                            onclick="removeScreenshot(${index})">
                            <i class="fa fa-times text-xs"></i>
                        </button>
                    `;
                    previewContainer.appendChild(preview);
                };
                reader.readAsDataURL(file);
            });
        }

        // 移除文件
        function removeFile(inputId, previewId, areaId) {
            const input = document.getElementById(inputId);
            const preview = document.getElementById(previewId);
            const area = document.getElementById(areaId);

            input.value = '';
            preview.innerHTML = '';
            preview.classList.add('hidden');
            area.classList.remove('border-primary');
        }

        // 移除截图
        function removeScreenshot(index) {
            const input = document.getElementById('app-screenshots');
            // 由于FileList只读，我们只能重置整个输入
            input.value = '';
            document.getElementById('screenshot-preview').innerHTML = '';
        }

        // 格式化文件大小
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // 表单提交
        function submitForm() {
            // 在实际应用中，这里会有AJAX请求发送表单数据
            // 这里仅做演示
            showToast('应用创建成功！正在提交审核...');

            // 模拟提交延迟
            setTimeout(() => {
                window.location.href = 'index.html';
            }, 2000);
        }

        // 显示提示消息
        function showToast(message) {
            const toast = document.getElementById('success-toast');
            const toastMessage = document.getElementById('toast-message');

            toastMessage.textContent = message;
            toast.classList.remove('translate-y-20', 'opacity-0');
            toast.classList.add('translate-y-0', 'opacity-100');

            // 3秒后隐藏
            setTimeout(() => {
                toast.classList.remove('translate-y-0', 'opacity-100');
                toast.classList.add('translate-y-20', 'opacity-0');
            }, 3000);
        }
    </script>
</body>
</html>